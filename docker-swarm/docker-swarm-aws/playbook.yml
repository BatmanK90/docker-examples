---
- name: setup docker on all nodes

  # name of the host to run this on.
  hosts: swarm_nodes, discovery_backend
  vars:

    # execute all commands as root
    ansible_become_user: root
    ansible_become_method: sudo
    ansible_become: true

  roles:
    # Only one role: Docker
  - install_docker

- name: setup consul daemon

  # name of the host to run this on.
  hosts: discovery_backend
  vars:

    # execute all commands as root
    ansible_become_user: root
    ansible_become_method: sudo
    ansible_become: true

  roles:
    # Only one role
  - setup_discovery

- name: setup swarm managers
  hosts: swarm_managers
  vars:

    # execute all commands as root
    ansible_become_user: root
    ansible_become_method: sudo
    ansible_become: true

  roles:
    # Only one role
  - setup_manager

- name: setup swarm workers
  hosts: swarm_workers
  vars:

    # execute all commands as root
    ansible_become_user: root
    ansible_become_method: sudo
    ansible_become: true

  roles:
    # Only one role
  - setup_worker
